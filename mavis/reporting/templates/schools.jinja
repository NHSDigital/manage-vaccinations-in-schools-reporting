{% from "components/filters.jinja" import filters %}
{% from "tables/macro.jinja" import table %}

{% extends 'layouts/dashboard.jinja' %}

{% block pageTitle %}Schools report | {{ app_title }}{% endblock %}

{% block dashboard_content %}

<div class="nhsuk-grid-row">
  <div class="app-grid-column-filters">
    {{ filters({
      "programmes": programmes,
      "year_groups": year_groups,
      "genders": genders,
      "current_filters": current_filters or {},
      "form_action": url_for('main.schools', workgroup=team.workgroup)
    }) }}
  </div>

  <div id="dashboard" class="app-grid-column-content">
    {% set rows = [] %}
    {% for school in schools_data %}
      {% set _ = rows.append([
        { "text": school.school_urn },
        { "text": school.school_name },
        { "text": school.cohort | thousands, "format": "numeric" },
        { "text": school.vaccinated | thousands, "format": "numeric" },
        { "text": school.not_vaccinated | thousands, "format": "numeric" }
      ]) %}
    {% endfor %}

    {{ table({
      "heading": "Schools",
      "tableClasses": "nhsuk-table--data",
      "panel": true,
      "head": [
        { "text": "URN" },
        { "text": "School" },
        { "text": "Cohort", "format": "numeric" },
        { "text": "Vaccinated", "format": "numeric" },
        { "text": "Not vaccinated", "format": "numeric" }
      ],
      "rows": rows
    }) }}

    <p class="nhsuk-body-m nhsuk-u-margin-bottom-6">
      This data was last updated on <strong>{{ last_updated_time }}</strong>.
    </p>

  </div>
</div>

{% endblock %}
